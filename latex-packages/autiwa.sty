\NeedsTeXFormat{LaTeX2e}[1999/01/01]
\ProvidesPackage{autiwa}[2011/06/01 Extension personnelle, V2.50]%aaaa/mm/dd
%voir le fichier change.log pour l'historique des modifications

%%% polices %%%
\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}  % OT2 c'est pour le cyrillique
\RequirePackage[frenchb]{babel}%russian est là pour la commande qui se trouve dans la macro \peigne
\RequirePackage[autolanguage]{numprint}
\RequirePackage[font=small,format=plain,labelsep=endash]{caption}

%meta paquet qui regroupe des environnements, des commandes persos et cie. Permet de les ajouter plus simplement dans mon paquet pour du latex normal, des beamers ou des posters. Ainsi les commandes ne sont qu'à un seul endroit.
\RequirePackage{autiwa-macros}


%%% mise en page %%%
\RequirePackage{multicol}%permet de mettre du texte sur plusieurs colonnes sans changer de pages (très pratique pour deux colonnes, vu que par défaut, il change de page
\RequirePackage{natbib}%améliore la bibliographie, surtout pour citer les publications scientifiques.
\RequirePackage{aas_macros}% contient les macros pour la déifnition des noms de journaux des publications scientifiques utilses pour les enterées bibtex de ADS.
\RequirePackage{frbib}%pour mettre la bibliographie en français
\RequirePackage[nottoc]{tocbibind}%pour que la bibliographie  et l'index apparaissent dans la table des matières. l'option permet de ne pas afficher la table des matières. (notlof, notlot pour table des figures et ou des tableaux)
\RequirePackage{xspace}%Permet à babel d'utiliser la macro xspace  partout où c'est nécessaire. (Voir la doc de babel pour de plus amples explications.)
\RequirePackage{acronym}%pour gérer les acronymes. Description du paquet dans mon pdf, ou dans la description du paquet acronym.sty
\RequirePackage[pdftex]{geometry}
\geometry{margin=2.5cm}%la redéfinition des marges doit se faire avant l'appel de fancyhdr. Sinon, les entêtes et pieds de pages auront les anciennes marges.
\RequirePackage{fancyhdr}
\setlength{\headheight}{13pt}%avertissement dû à fancyhdr disant que \headheight is too small (12.0pt)
\pagestyle{fancy}
\fancyhf{}
%odd pages correspondent aux pages de droite
%even pages correspondant aux pages de gauche
\fancyhead[LO,RE]{\thepage}
\fancyhead[RO]{\nouppercase{\leftmark}}
\fancyhead[LE]{\nouppercase{\rightmark}}
\RequirePackage[pdftex]{hyperref}%l'option pagebackref permet d'afficher les pages dans lesquelles sont citées les références (en gros, la position des labels je pense)
\hypersetup{
  colorlinks=true, %colorise les liens
  breaklinks=true, %permet le retour à la ligne dans les liens trop longs
  urlcolor= blue,  %couleur des hyperliens
  linkcolor= refcolor, %couleur des liens internes
  plainpages=false,  %pour palier à "Bookmark problems can occur when you have duplicate page numbers, for example, if you have a page i and a page 1."
  citecolor=refcolor % pour définir la couleur des liens de bibliographie
}

%%% graphiques et images %%%

\RequirePackage{afterpage} % permet de placer des images plus intelligemment
\RequirePackage{graphics}
\RequirePackage[pdftex]{graphicx}
\usepackage[lflt]{floatflt}%Pour ajouter des graphiques dans des paragraphes, entourés de texte. L'option signifie que le graphique sera mis par défaut sur la gauche du paragraphe. Pour appeler un environnement : \begin{floatingfigure}[l]{0.5\linewidth}. Pour plus d'info, se reporter au pdf de latex que je fais ou à la doc du paquet.
\RequirePackage[justification=centerfirst]{subfig}%pour pouvoir mettre plusieurs figures dans le même environnement de figure, avec plusieurs caption
\RequirePackage{wrapfig}%pour ma commande \attention{} parce que floatflt marche, mais m'indente de la même manière tout les autres paragraphes...

%%% divers %%%
\pdfcompresslevel=9
\RequirePackage{fancybox}
\RequirePackage{shorttoc}
\RequirePackage{makeidx} %pour faire un index. J'ai mis la commande d'indexation dans \gras{} d'ailleurs. Ensuite, on crée l'index via la commande \makeindex et on l'affiche via la commande \printindex. Pour indexer un mot, il faut écrire \index{mot}. Attention à respecter la casse pour le même mot.
\RequirePackage{ifthen}%permet de faire des tests, utile pour les commandes de commath que j'ai redéfinies ici (à cause d'une incompatibilité expliquée dans le change.log ; va sans doute servir pour d'autres commandes, j'en ai besoin pour \gras{}

%%% environnements et tableaux %%%
\RequirePackage{shapepar}%pour faire des paragraphes mis en formes selon des figures, par exemple une forme d'étoile, d'hexagone, de coeur et ainsi de suite.


%%% verbatim %%%
\RequirePackage{example}%pour avoir, en un environnement, deux colonnes, la premières en verbatimn, et la 2e qui exécute le code.
\RequirePackage{listings}
\lstnewenvironment{latex}[1][]{
\lstset{language=TeX,
   basicstyle=\ttfamily\small,
   columns=flexible,
   escapechar=+}}{}

\RequirePackage{paralist}%permet d'utiliser l'environnement inparaenum qui est une liste numérotée formatée dans un paragraphe (c'est à dire sans retour à la ligne) ; je l'utilise pour définir mon propre environnement de liste, à défaut de savoir le faire depuis la base.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%mise en page selon qu'on est en article, report, ou autre. (à voir)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\@ifclassloaded{article}{
\renewcommand\theequation{\thesection.\arabic{equation}}%permet de numéroter les équations à partir du numéro de section
\@addtoreset{equation}{section}%permet de remettre à zéro le compteur des équations à chaque changement de section.
\newcommand{\annexe}{\clearpage \appendix \fancyhf{} \chead{Annexe}\cfoot{\thepage}}
}

\@ifclassloaded{report}{
\RequirePackage[Lenny]{fncychap} % beaux chapitres ; Sonny, Lenny, Glenn, Conny, Rejne, Bjarne

\renewcommand\theequation{\thechapter.\arabic{equation}}
\@addtoreset{equation}{chapter}
% \renewcommand{\thechapter}{\Alph{chapter}}
}


\DeclareMathSizes{10}{10}{6}{5}
\DeclareMathSizes{11}{11}{7}{5}
\DeclareMathSizes{12}{12}{7}{5}

%%%%%%%%%%%%%%%%%%%%%%%%%%
% Nouveaux environnements basés sur le paquet theorem
%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{theorem}
    \theoremheaderfont{\scshape} \theoremstyle{break} % style des entêtes
    \theorembodyfont{\normalfont} % style de police
    \newtheorem{theoreme}{Théorème}
    \newtheorem{definition}{Définition}
    \newtheorem{demonstration}{Démonstration}
    \newtheorem{propriete}{Propriété}

%%%%%%%%%%%%%%%%%%%%%%%%%%
% Macros diverses
%%%%%%%%%%%%%%%%%%%%%%%%%%
\FrenchFootnotes % pour les notes de bas de page
\AddThinSpaceBeforeFootnotes % pour les puristes (donc tout le monde!) qui veulent une espace fine entre le mot et l'appel de note

%%%%%%%%%%%%%%%%%%%%%%%%%%
% macro pour le glossaire
%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\glossaire}[2]{\item[#1] #2}
\newcommand{\boiteentreeglossaire}[1]{%
	\parbox[b]{\labelwidth}{%
    \setlength{\fboxsep}{3pt}%
    \setlength{\fboxrule}{.4pt}%
    \shadowbox{\sffamily#1}\\\hfill\mbox{}}}
	\newenvironment{leglossaire}{\newpage\section*{Glossaire}%
\addcontentsline{toc}{section}{Glossaire}\begin{list}{}{%
      \setlength{\labelwidth}{.5\textwidth}%
      \setlength{\labelsep}{-.8\labelwidth}%
      \setlength{\itemindent}{\parindent}%
      \setlength{\leftmargin}{25pt}%
      \setlength{\rightmargin}{0pt}%
      \setlength{\itemsep}{.8\baselineskip}%
      \renewcommand{\makelabel}[1]{\boiteentreeglossaire{##1}}}}
{\end{list}}
%on utilise l'environnement 'leglossaire' pour commencer le glossaire, et dans cet environnement, on utilise la commande 'glossaire' avec pour premier argument le nom, et pour 2e argument la description. attention, il faut écrire les définition dans l'ordre où on veut qu'elles apparaissent. Je ne sais pas comment améliorer ça et faire qu'il les classe tout seul.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% déclaration des options qui redéfinissent certaines fonctions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareOption{print}{%
\newgray{lightgray}{1}
\hypersetup{
  colorlinks=false, %colorise les liens
  breaklinks=true, %permet le retour à la ligne dans les liens trop longs
  urlcolor= dark,  %couleur des hyperliens
  linkcolor= black, %couleur des liens internes
  plainpages=false,  %pour palier à "Bookmark problems can occur when you have duplicate page numbers, for example, if you have a page i and a page 1."
  citecolor=black % pour définir la couleur des liens de bibliographie
}
\newrgbcolor{marou}{0 0 0}%redéfinie cette couleur, pour notamment rendre les titres noirs, et aussi les résultats de la commande \gras{}
}

\ProcessOptions

\endinput
